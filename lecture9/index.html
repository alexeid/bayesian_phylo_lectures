---
lecture_num: 9
---

<section>
    <h2>The Phylogenetic Likelihood</h2>

    <blockquote style="font-size:2em;margin-top:10%">
        $$P(A|T, \mu)$$
    </blockquote>

    <ul style="width:80%;margin-top:2em">
        <li>$A$ is a multiple sequence alignment of $n$ sequences,</li>
        <li>$T$ is a phylogenetic tree with $n$ leaves, and</li>
        <li>$\mu$ are the parameters of the chosen CTMC-based model of sequence evolution.</li>
        <li>Just a product of site pattern propabilities: note the obvious
        generalizations to multiple alignments that share a tree, or to phylogenetic networks that allow
        different sites to evolve under distinct "local" trees.</li>
    </ul>

    <p><i>We're Bayesians: we need a probability distribution for $T$!</i></p>
</section>

<section>
    <h2>The Phylogenetic Posterior</h2>

    <blockquote style="margin-top:10%;font-size:1em">
        $$P(T,Q|A) = \frac{1}{P(A)}P(A|T,\mu)P(T|\theta)P(\mu,\theta)$$
    </blockquote>

    <ul style="width:80%; margin-top:1em">
        <li>$P(T|\theta)$ is the "tree prior" parameterized by $\theta$.</li>
        <li>$P(\mu,\theta)$ are the parameter priors.</li>
    </ul>

    <div class="textbox" style="margin-top:2em;width:80%;text-align:center;margin-left:10%">
        <div class="title">Questions</div>
        <ul>
            <li>What is $P(A)$?</li>
            <li>Is the tree prior really a prior? (I.e. does it depend on the data?)</li>
        </ul>
    </div>
</section>

<section>
    <h2>The Neutrality Assumption</h2>

    <p>Because of the way we've factorized the joint probability for the data and model parameters, we
    are implicitly assuming that our alignment could have been produced in the following fashion:</p>

    <div style="width:100%; height:350px; position:relative">
        <img class="fragment" data-src="neutrality1.svg" style="position:absolute;top:0;left:0;width:1000px">
        <img class="fragment" data-src="neutrality2.svg" style="position:absolute;top:0;left:0;width:1000px;background-color:white">
        <img class="fragment" data-src="neutrality3.svg" style="position:absolute;top:0;left:0;width:1000px;background-color:white">
    </div>

    <p class="fragment">Separating the process of tree generation from that of
    sequence evolution implies neutrality.</p>
</section>


<section>
    <h2>Tree Priors</h2>

    <ul>
        <li></li>
    </ul>
</section>

<section>
    <h3>Uniform tree prior</h3>
</section>

<section>
    <h3>The Yule model for speciation</h3>
</section>

<section>
    <h3>Birth-death priors</h3>
</section>

<section>
    <h3>Birth-death-sampling priors</h3>
</section>

<section>
    <h3>Coalescent priors</h3>
</section>

<section>
    <h3>Multi-species coalescent priors</h3>
</section>

<section class="center">
    <h2>MCMC in Tree Space</h2>
</section>

<section>
    <h3>Real MCMC algorithm</h3>

    <p>MCMC works by simulating a stochastic trajectory according to:</p>
    $$p_{i+1}(x)=\int p_i(x')W(x|x')\mathrm{d}x'$$
    <p>where</p>
    $$W(x'|x) = q(x'|x)\alpha(x'|x) + \left(1-\int q(x''|x)\alpha(x''|x)\mathrm{d}x''\right)\delta(x'-x)$$

    <p>A sufficient (but unnecessary!) condition for $\pi(x)$ to be the equilibrium distribution is detailed ballance, which implies:</p>
    $$\pi(x')q(x|x')\alpha(x|x')=\pi(x)q(x'|x)\alpha(x'|x)$$
    <p>which is satisfied by the following acceptance probability:</p>
    $$\alpha(x'|x)=\min\left[1, \frac{\pi(x')}{\pi(x)}\times\frac{q(x|x')}{q(x'|x)}\right]$$
</section>

<section>
    <h3>Proposal distribtuions/operators for Trees</h3>

    <blockquote>
        Need to identify a set of proposals forming $q(x'|x)=\sum_j w_j
        q_j(x'|x)$ when $x$ is a point in tree space.  (The $w_j$ are
        <b>weights</b>: probabilities that define how frequently a particular
        proposal operator is used by the algorithm.)
    </blockquote>
</section>

<section>
    <h3>Stopping criteria</h3>
</section>


<section class="center">
    <h2>Post-processing</h2>
</section>


<section>
    <h2>Bayesian Phylogenetic Inference Software</h2>

    <ul>
        <li>BEAST/BEAST2</li>
        <li>MrBayes</li>
        <li>RevBayes</li>
        <li>PHYLIP</li>

        <li>MIGRATE</li>
        <li>ClonalFrame/ClonalOrigin</li>
    </ul>
</section>

<section>
    <h2>Summary</h2>
</section>

<section>
    <h2>Reading</h2>
</section>
