---
lecture_num: 10
---

<section>
    <h2>Tree space</h2>

    <img data-src="fig_1_treesubspace.svg" style="width:52%">
    
    <ul>
    <li>A two-dimensional space representing all
possible time-trees for the topology ((1,2),3). 
<li>x and y, are the two inter-coalescent intervals($t_{root} = x + y$). 
<li>Three trees are displayed, with their arithmetic mean tree. 
<li>Dashed lines show the shortest distances to mean (i.e. deviations from the mean).

</ul>

</section>

<section>
    <h2>Tree space</h2>
    
    <img data-src="fig_2_treespace.svg" style="width:55%">


<ul>
<li>The simplest non-trivial tree space for time-trees ($n=3$)
<li> Each non-degenerate tree topology is a two-dimensional space.
<li> These subspaces meet at a shared edge representing the star
tree, which is a one-dimensional subspace (parameter is the age of the root)
<li> Dashed lines are shortest distances between the four displayed trees.
</ul>
</section>

<section>

<h2>Another space of tip-labeled time-trees</h2>

    <img data-src="tSpace2d.svg" style="height:80%">


</section>

<section>

<h2>Projection of tree space on 4 taxa</h2>

    <img data-src="tauSpace.svg" style="height:80%">

<p>This is a projection of a part of 4-taxa tree space. The full number of subspaces is actually 18, but we only show 6  of them here. Also each subspace is actually a cube, but we show them as squares by fixing the tip-most interval.</p>

</section>

<section>
<h2>Tree space</h2>
<ul class="spaced" style="margin-top:5%; width:85%">
<li> Tree space is a complex space made up of a subspace for each tree topology.
<li> For time trees of $n$ taxa each subspace is positive $R^{n-1}$ or an $(n-1)$-dimensional <a href="https://en.wikipedia.org/wiki/Simplex">simplex</a>, depending on the parameterization.
<li> Tree space has a combinatorial component that can be described by a graph whose vertices are distinct tree topologies and whose edges connect topologies whose subspaces share a face.
<li> Tree space can be explored by random walks on the graph connecting tree topologies, but also by larger jumps like subtree-prune-and-regraft (SPR).
<li> The continuous component of tree space describe the divergence times on each tree must also be explored in Bayesian phylogenetic inference. 
</ul>

</section>

<section>

<h2>Genetic distance = rate $\times$ time</h2>

<p> The strict molecular clock parameterization </p>

    <img data-src="fig_StrictClockParam.svg" style="width:90%">

<p> The "substitution tree" is in units of expected substitutions, i.e. genetic distances.</p>

</section>

<section>

<h2>Non-identifiability of rate and time</h2>

    <img data-src="fig_NonidentifiabilityRateTime.svg" style="width:85%">

</section>

<section>

<h2>Identifiability via node calibrations</h2>

  <p>Suppose fossil evidence shows the common ancestor of species A, B and C lived 25-35 Mya.</p>

    <img data-src="fig_NodeCalibration.png" style="width:85%">

  <p>With a strict molecular clock, only the age (range) of a single node in the tree is needed in order to
  interpolate and extrapolate the ages of all other divergence times. 
  <p>Once a known node age like this "calibrates" the tree, the
  genetic distances can be separated into an absolute rate and divergence times.</p>
</section>

<section>

<h2>Identifiability via leaf calibrations</h2>

  <p>Suppose sample C is ancient DNA from subfossil remains dated to 20 thousand years ago.</p>

    <img data-src="fig_LeafCalibration.png" style="width:85%">

  <p>With a strict molecular clock, calibration is possible with data from non-contemporaneous taxa (e.g. ancient DNA, or samples from different years in a rapidly evolving virus). 
  <p>Again, once one or more non-contemporaneous leaf nodes like this "calibrate" the time scale of the tree, the
  genetic distances can be separated into an absolute rate and divergence times.</p>
</section>


<section>
<h2>Genetic distance = rate $\times$ time</h2>

<p> The relaxed molecular clock parameterization </p>


    <img data-src="fig_RelaxedClockParam.png" style="width:90%">

<p> The "substitution tree" is in units of expected substitutions, i.e. genetic distances.</p>

</section>

<section>

<h2>Genetic distance = rate $\times$ time</h2>

<p> The relaxed molecular clock parameterization </p>


    <img data-src="fig_RelaxedClockParam2.png" style="width:90%">

<p> The "substitution tree" is in units of expected substitutions, i.e. genetic distances.</p>

</section>


<section>

<h2>Non-identifiability of rate and time</h2>

    <img data-src="fig_RelaxedNonidentifiabilityRateTime.png" style="width:80%">

</section>

<section>
<h2>Bayesian phylogenetic posterior with a molecular clock</h2>

    <p>Strict molecular clock:</p>

    <p>$$T = \color{darkgreen}{\mu} \times \color{red}{g}$$</p>

    <p>$$P(\color{red}{g}, \color{darkgreen}{\mu}, \theta|D) = \frac{1}{\Pr(D)}\Pr(D|T)P(\color{red}{g}|\theta)P(\color{darkgreen}{\mu})P(\theta)$$</p>

    <p>Relaxed molecular clock:</p>

    <p>$$T = \color{darkgreen}{\vec{\mu}} \star \color{red}{g}$$</p>

    <p>$$P(\color{red}{g}, \color{darkgreen}{\vec{\mu}},\theta|D) = \frac{1}{\Pr(D)}\Pr(D|T)P(\color{red}{g}|\theta)P(\color{darkgreen}{\vec{\mu}})P(\theta)$$</p>
    
    <ul> 
    <li>where $P(\color{darkgreen}{\vec{\mu}})$ is the (model-based) prior for how much rate variation you allow.
    <li> The phylogenetic likelihood only depends on the substitution tree $T$: $\Pr(D|T)$.
    <li> The tree prior only depends on the time-tree $\color{red}{g}$: $P(\color{red}{g}|\theta)$.
    <li> By fixing $\color{darkgreen}{\vec{\mu}} = 1$ we get a time-tree ($\color{red}{g}$) in units of substitutions (i.e. genetic distance).
    </ul>

</section>

<section>
<h2>How many parameters are in each of these models?</h2>

    <p>Unrooted tree, no molecular clock constraint</p>
    
    <ul>
    <li>unrooted substitution tree $T$ has $2n-3$ random variables, one for each branch length</li>
    </ul>

    <p>Strict molecular clock:</p>

    <ul>
    <li>$\color{red}{g}$ has $n-1$ random variables, one for the age of each internal node.</li>
    <li>$\color{darkgreen}{\mu}$ is a one-dimensional parameter</li>
    <li>total of $n$ dimensions</li>
    </ul>

    <p>Relaxed molecular clock:</p>

    <ul>
    <li>$\color{red}{g}$ has $n-1$ random variables, one for the age of each internal node.</li>
    <li>$\color{darkgreen}{\vec{\mu}}$ contains $2n-2$ rate parameters</li>
    <li>total of $3n-3$ dimensions</li>
    <li>Only identifiable by priors on rates and times: $P(\color{darkgreen}{\vec{\mu}})$, $P(\color{red}{g}|\theta)$
    </ul>
    
</section>

<section>
<h2>What models of rate variation should we consider?</h2>

    <p> <b>Autocorrelated models</b> of rate variation assume the rate evolves down the tree:</p>
    
    $$P(\color{darkgreen}{\vec{\mu}}) = \prod_i P(\mu_i | \mu_{\text{parent}(i)})$$
    
<p> e.g.     $\text{log}(\mu_i) \sim \text{Normal}(\text{log}(\mu_{\text{parent}(i)}), \sigma t_i)$, where $t_i$ is the length of time separating the $i$'th node and its parent in the time tree and $\sigma$ is the rate of evolution of the rate of evolution per unit time in log space.
    <p> <b>Uncorrelated models</b> of rate variation assume each branch has a rate drawn independently from a distribution</p>

    $$P(\color{darkgreen}{\vec{\mu}}) = \prod_i P(\mu_i | \nu)$$

    <p> where $\nu$ are parameters of the distribution they are drawn from, e.g. $\text{log}(\mu_i) \sim \text{Normal}(M, S)$, where $M$ is the mean of the log rate and $S$ is the standard deviation of the log-rate.</p>
    
</section>

